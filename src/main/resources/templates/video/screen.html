<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
<style>
    .video-window{
        float: left;
        margin-left: 1%;
        margin-bottom: 1%;
        width: 360px;
        height: 240px;
        position: relative;
        background-color: #000;
    }
</style>

    <script th:src="@{../../plugins/cyberplayer/cyberplayer.js}"></script>
</head>
<body>
<div class="row col-sm-9 video-show">
    <table>
        <tr>
            <td>
                <div id="playercontainer1" class="video-window" alt="1" ></div>
            </td>
            <td>
                <div id="playercontainer2" class="video-window"  alt="2" ></div>
            </td>
        </tr>
        <tr>
            <td>
                <div id="playercontainer3" class="video-window" alt="3" ></div>
            </td>
            <td>
                <div id="playercontainer4" class="video-window" alt="4" ></div>
            </td>

        </tr>
    </table>




</div>
<script>

    window.addEventListener("message",function(obj){
        var data = obj.data;
        var action = data.action;

        console.log("message from  father:" + data);
    });

     var current = 0;
     var size = 4;
     var playtable = new Array();
     playtable[0] = 0;
     playtable[1] = 0;
     playtable[2] = 0;
     playtable[3] = 0;

    function startplay( rtmpurl) {

     var wind = findUnused();
         var player = cyberplayer(wind).setup({
             width: 360,
             height: 240,
             file: rtmpurl, // <—rtmp直播地址
             autostart: true,
             stretching: "uniform",
             volume: 100,
             controls: true,
             rtmp: {
                 reconnecttime: 5, // rtmp直播的重连次数
                 bufferlength: 1 // 缓冲多少秒之后开始播放 默认1秒
             },
             ak: ""//"cc94de6803904f2ca7159eedeaced55d" // 公有云平台注册即可获得accessKey
         });

     }

    function findUnused() {
     var index = 0;
     for(i=0;i<4;i++) {
         if (playtable[i] == 0) {
             index = i + 1;
             playtable[i] = 1;
             current = index;
             break;
         }
     }
     if( index == 0){
         index = (current + 1)%size;
     }
     var wind = "playercontainer"+index;

     return wind;
 }
</script>

</body>
</html>